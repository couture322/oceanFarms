---
title: "Farm MS figures"
author: "Jessica L. Couture"
output:
  html_document:
    code_folding: hide
    fig_width: 12
  pdf_document: default
---


```{r warning=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)

library(tidyverse)
library(patchwork)
library(paletteer)
library(knitr)

```

Figures for ocean aquaculture impacts manuscript. First, one to define the model (fig 1), then represent general results and finally to give and idea of how changing key parameters like movement, attraction, farm size and impacts on the population change the results. Figure 1 will be a diagram of a farm that highlights and explains the parameters I mess with. 

## Figure 1: Farm diagram

![Figure 1: Diagram of ocean farm with key parameters indicated.](imgs/aqFish_fig1.png)

## Figure 2: Equilibrium catches at different MPA and farm sizes

Attraction is varied and benefits from the farm are included but held constant. The committee liked the catches plot since it was most dynamic, but wanted it pulled apart to make the message that breaking the farms up into smaller spaces makes a difference, so this figure will have 2 panels, one with one large farm (A) and a second with farms broken up into smaller spaces (B). 

```{r fig.height=5}

zerosDf<-data.frame(mpaSize=c(0,0,0,0),attr=c(1,3,9,15),biomass=c(NA,NA,NA,NA),catch=c(NA,NA,NA,NA),diffBm=c(NA,NA,NA,NA),diffCtch=c(1,1,1,1))

### Weak fishery management

msAttrOA<-read_csv("runs/openAccess/farmEq_msAttrOALg.csv")

msAttrOAxs<-read_csv("runs/openAccess/farmEq_msAttrOAXSm.csv") # 4 farms at 5 patches each
nullOA<-read_csv("runs/openAccess/nullOA.csv")


### Calculate biomass and catch differences 
msAttrOA2<-msAttrOA%>%
  mutate(diffBm=biomass/as.numeric(nullOA[1,"biomass"]),
         diffCtch=catch/as.numeric(nullOA[1,"catch"]))%>%
  filter(mpaSize<=0.2)%>%
  bind_rows(zerosDf,.)

msAttrOAxs2<-msAttrOAxs%>%
  mutate(diffBm=biomass/as.numeric(nullOA[1,"biomass"]),
         diffCtch=catch/as.numeric(nullOA[1,"catch"]))%>%
  filter(mpaSize<=0.2)%>%
  bind_rows(zerosDf,.)

### plot mpaSize by attraction

# attrCols<-beyonce_palette(19)[c(5,2:4)]

attrCols<-paletteer_d("beyonce::X19")[c(5,2:4)] # edit bc beyonce package doesn't work for this updated R version. Paletteer works th

names(attrCols)<-c("1","3","9","15")

sizeAttrCatch<-ggplot(msAttrOA2,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)))+
  geom_hline(yintercept = 0,color="gray66")+
  # geom_line(size=0.8)+
  geom_smooth(size=0.8,se=FALSE)+
  labs(title = "One large farm",y="Catch biomass",x="")+
  scale_y_continuous(limits = c(25,130))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16))

sizeAttrCatchS<-ggplot()+ ## replaced sm with xsm to accentuate differences (smaller farms)
  geom_hline(yintercept = 100,color="gray66")+
  # geom_line(data=msAttrOAxs2,aes(x=mpaSize,y=diffCtch,group=as.factor(attr),color=as.factor(attr)),size=0.8)+
  geom_smooth(data=msAttrOAxs2,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)),size=0.8,se=FALSE)+
  labs(title = "Several smaller farms",y="",x="")+
  scale_y_continuous(limits = c(25,130))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16))

## combined x-lab
x_lab <- 
  ggplot() + 
  annotate(geom = "text", x = 1, y = 1, label = "Total farm area (% of total range)", size=6) +
  theme_void()

fig1Plts<-sizeAttrCatch+sizeAttrCatchS+plot_layout(guides = "collect")+plot_annotation(tag_levels = "A", theme = theme(plot.title = element_text(size = 18)))

# (fig1Plts/x_lab) + plot_layout(heights = c(1,0.05))

```

```{r fig.height=8}

### Strong fishery management

msAttrCE<-read_csv("runs/constantEffortMSY/farmEq_msAttCE.csv")
# msAttrOAs<-read_csv("runs/aqMS/farmEq_msAttrOASm.csv") # 2 farms at 10 patches each
msAttrCExs<-read_csv("runs/constantEffortMSY/farmEq_msAttCEsm.csv") # 4 farms at 5 patches each

nullCE<-read_csv("runs/constantEffortMSY/nullCE.csv")

# nullCE<-read_csv("runs/aqMS/nullCE.csv")

msAttrCE2<-msAttrCE%>%
  mutate(diffBm=biomass/as.numeric(nullCE[1,"biomass"]),
         diffCtch=catch/as.numeric(nullCE[1,"catch"]))

msAttrCExs2<-msAttrCExs%>%
  mutate(diffBm=biomass/as.numeric(nullCE[1,"biomass"]),
         diffCtch=catch/as.numeric(nullCE[1,"catch"]))

### plot mpaSize by attraction

sizeAttrCatchCE<-ggplot(msAttrCE2,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(size=0.8,se=FALSE)+
  #geom_point()+
  labs(title = "One large farm",y="Catch (% relative to no farm)",x="")+
  scale_y_continuous(limits = c(25,130))+
  scale_x_continuous(breaks = seq(0.2,0.8,by=0.2),labels = seq(0.2,0.8,by=0.2)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16),
        plot.title = element_text(size=20))

sizeAttrCatchSce<-ggplot()+ ## replaced sm with xsm to excentuate differences (smaller farms)
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(data=msAttrCExs2,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)),size=0.8,se=FALSE)+
  labs(title = "Several smaller farms",y="",x="")+
  scale_y_continuous(limits = c(25,130))+
  scale_x_continuous(breaks = seq(0.2,0.8,by=0.2),labels = seq(0.2,0.8,by=0.2)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16),
        plot.title = element_text(size=20))

fig1PltsCE<-sizeAttrCatchCE+sizeAttrCatchSce+plot_layout(guides = "collect")+plot_annotation(tag_levels = "A", theme = theme(plot.title = element_text(size = 18)))

fig2quad<-(sizeAttrCatchCE+sizeAttrCatchSce)/(sizeAttrCatch+sizeAttrCatchS)+
  plot_layout(guides = "collect")+
  plot_annotation(tag_levels = "A")&
    theme(plot.tag = element_text(face = 'bold'))

fig2quad

```

## Figure 2b: truncate and zoom into 0-20% farms

```{r fig.height=5}

### Weak fishery management

msAttrOA20<-read_csv("runs/openAccess/farmEq_msAttOALg_20.csv")

msAttrOAxs20<-read_csv("runs/openAccess/farmEq_msAttOAXSm_20.csv") # 4 farms at 5 patches each

### Calculate biomass and catch differences 
msAttrOA202<-msAttrOA20%>%
  mutate(diffBm=biomass/as.numeric(nullOA[1,"biomass"]),
         diffCtch=catch/as.numeric(nullOA[1,"catch"]))%>%
  bind_rows(zerosDf,.)

msAttrOAxs202<-msAttrOAxs20%>%
  mutate(diffBm=biomass/as.numeric(nullOA[1,"biomass"]),
         diffCtch=catch/as.numeric(nullOA[1,"catch"]))%>%
  bind_rows(zerosDf,.)

### plot mpaSize by attraction

sizeAttrCatch20<-ggplot(msAttrOA202,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_line(size=0.8)+
  # geom_smooth(size=0.8,se=FALSE)+
  labs(y="\n\n",x="")+
  scale_y_continuous(limits = c(55,135))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16))

sizeAttrCatchS20<-ggplot()+ ## replaced sm with xsm to accentuate differences (smaller farms)
  geom_hline(yintercept = 100,color="gray66")+
  geom_line(data=msAttrOAxs202,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)),size=0.8)+
  # geom_smooth(data=msAttrOAxs202,aes(x=mpaSize,y=diffCtch,group=as.factor(attr),color=as.factor(attr)),size=0.8,se=FALSE)+
   labs(y="\n\n",x="")+
  scale_y_continuous(limits = c(55,135))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16))

fig1Plts20<-sizeAttrCatch20+sizeAttrCatchS20+plot_layout(guides = "collect")+plot_annotation(tag_levels = "A", theme = theme(plot.title = element_text(size = 18)))

################################
### Strong fishery management

msAttrCE20<-read_csv("runs/constantEffortMSY/farmEq_msAttCELg_20.csv")
# msAttrOAs<-read_csv("runs/aqMS/farmEq_msAttrOASm.csv") # 2 farms at 10 patches each
msAttrCExs20<-read_csv("runs/constantEffortMSY/farmEq_msAttCEXsm_20.csv") # 4 farms at 5 patches each


msAttrCE202<-msAttrCE20%>%
  mutate(diffBm=biomass/as.numeric(nullCE[1,"biomass"]),
         diffCtch=catch/as.numeric(nullCE[1,"catch"]))%>%
  bind_rows(zerosDf,.)

msAttrCExs202<-msAttrCExs20%>%
  mutate(diffBm=biomass/as.numeric(nullCE[1,"biomass"]),
         diffCtch=catch/as.numeric(nullCE[1,"catch"]))%>%
  bind_rows(zerosDf,.)

### plot mpaSize by attraction

sizeAttrCatchCE20<-ggplot(msAttrCE202,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_line(size=0.8)+
  # geom_smooth(size=0.8,se=FALSE)+
  #geom_point()+
   labs(y="\n\n",x="")+
  scale_y_continuous(limits = c(55,135))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16),
        plot.title = element_text(size=20))

sizeAttrCatchSce20<-ggplot()+ ## replaced sm with xsm to excentuate differences (smaller farms)
  geom_hline(yintercept = 100,color="gray66")+
  geom_line(data=msAttrCExs202,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)),size=0.8)+
  # geom_smooth(data=msAttrCExs202,aes(x=mpaSize,y=diffCtch*100,group=as.factor(attr),color=as.factor(attr)),size=0.8,se=FALSE)+
   labs(y="\n\n",x="")+
  scale_y_continuous(limits = c(55,135))+
  scale_x_continuous(breaks = seq(0,0.2,by=0.05),labels = seq(0,0.2,by=0.05)*100)+
  scale_color_manual(values = attrCols,name="Attraction",labels=c("None","Low","Moderate","High"))+
  theme_bw()+
    theme(axis.text=element_text(size=12),
          axis.title = element_text(size=16),
          legend.text = element_text(size=12),
        legend.title = element_text(size=16),
        plot.title = element_text(size=20))

fig1PltsCE20<-sizeAttrCatchCE20+sizeAttrCatchSce20+plot_layout(guides = "collect")+plot_annotation(tag_levels = "A", theme = theme(plot.title = element_text(size = 18)))

fig2quad20<-(sizeAttrCatchCE20+sizeAttrCatchSce20)/(sizeAttrCatch20+sizeAttrCatchS20)+
  plot_layout(guides = "collect")+
  plot_annotation(tag_levels = "A")&
    theme(plot.tag = element_text(face = 'bold'))

fig2quad20

```

***

## Figure 3: Equilibrium catches with positive and negative impacts to wild populations

Relative differences in catch biomass compared to no farm over a range of total farm areas. Farms are all divided into several smaller farms. Farm scenarios with positive (A, C) and negative impacts to the wild population (C, D), under strong (A, B) and weak (B, D) fishery management. 


```{r}

### Farm size colors:
# szCols<-c(beyonce_palette(129)[c(1,2,4)],beyonce_palette(6)[5])#paletteer_d("ghibli::PonyoMedium")[c(1,3,6,4)]

szCols<-c(paletteer_d("beyonce::X129")[c(1,2,4)], paletteer_d("beyonce::X6")[5])# edit bc beyonce package doesn't work for this updated R version. Paletteer works th

names(szCols)<-c("60","20","3","0")

### control CE data
nullCE<-read_csv("runs/constantEffortMSY/nullCE.csv")

### Benefits to wild population

szMgmtBen<-read_csv("runs/movement/farmEq_mpaMgmtAMBen.csv")

szMgmtBen2<-szMgmtBen%>%
  mutate(diffBm=case_when(mgmt == "oa" ~  biomass/as.numeric(nullOA[1,"biomass"]),
                          TRUE ~ biomass/as.numeric(nullCE[1,"biomass"])),
         diffCtch=case_when(mgmt=="oa" ~  catch/as.numeric(nullOA[1,"catch"]),
                          TRUE ~ catch/as.numeric(nullCE[1,"catch"])))

zeros<-data.frame(mpaSz=0,
                  aMove=rep(c(0,3,20,60),2),
                  mgmt=rep(c("oa","ce"),each=4),
                  diffBm=1,
                  diffCtch=1)

szMgmtBen3<-szMgmtBen2%>%
  bind_rows(.,zeros)

### open access

szMgmtBenCtchOA<-ggplot(szMgmtBen3[szMgmtBen3$mgmt=="oa",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(size=0.8,se=FALSE)+#geom_line(size=0.8)+
  scale_color_manual(values = szCols,name="Adult\nmovement",labels=c("High","Moderate","Low","None"))+#c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(9,215))+
  labs(x="",y="\n\n",title = "")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

### constant effort at MSY

szMgmtBenCtchCE<-ggplot(szMgmtBen3[szMgmtBen3$mgmt=="ce",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(size=0.8,se=FALSE)+#geom_line(size=0.8)+
  scale_color_manual(values = szCols,name="Adult\nmovement",labels=c("High","Moderate","Low","None"))+#c("High","Moderate","Low","None"))+#c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(9,215))+
  labs(x="",y="\n\n",title = "Positive impacts\n")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

goodPlt<-szMgmtBenCtchOA + szMgmtBenCtchCE
  # plot_annotation(title = "Adult movement by number of farms - benefits", theme = theme(plot.title = element_text(size = 18)))

```

```{r fig.height=8}

### Stress/damage to wild population

szMgmtNeg<-read_csv("runs/movement/farmEq_mpaMgmtAMNeg.csv")

szMgmtNeg2<-szMgmtNeg%>%
  mutate(diffBm=case_when(mgmt == "oa" ~  biomass/as.numeric(nullOA[1,"biomass"]),
                          TRUE ~ biomass/as.numeric(nullCE[1,"biomass"])),
         diffCtch=case_when(mgmt=="oa" ~  catch/as.numeric(nullOA[1,"catch"]),
                          TRUE ~ catch/as.numeric(nullCE[1,"catch"])))

szMgmtNeg3<-szMgmtNeg2%>%
  bind_rows(.,zeros)

### Open access

szMgmtNegCtchOA<-ggplot(szMgmtNeg3[szMgmtNeg3$mgmt=="oa",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(size=0.8,se=FALSE)+#geom_line(size=0.8)+
  scale_color_manual(values = szCols,name="Adult\nmovement",labels=c("High","Moderate","Low","None"))+#c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(9,215))+
  labs(x="",y="\n\n",title = "")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))


#constant effort at MSY

szMgmtNegCtchCE<-ggplot(szMgmtNeg3[szMgmtNeg3$mgmt=="ce",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  geom_smooth(size=0.8,se=FALSE)+#geom_line(size=0.8)+
  scale_color_manual(values = szCols,name="Adult\nmovement",labels=c("High","Moderate","Low","None"))+#c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(9,215))+
  labs(x="",y="\n\n",title = "Negative impacts\n")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

fig3Plts<-((szMgmtBenCtchCE + szMgmtNegCtchCE)/(szMgmtBenCtchOA + szMgmtNegCtchOA )) +
  plot_annotation(tag_levels = 'A') + 
  plot_layout(guides="collect")


fig3Plts
# (fig2Plts/x_lab2) + plot_layout(heights = c(1,0.05))

```

### Truncate x-axis to 0-20%

```{r}

### Benefits to wild population

szMgmtBen20<-read_csv("runs/movement/farmEq_mpaMgmtAMBen_20.csv")

szMgmtBen202<-szMgmtBen%>%
  mutate(diffBm=case_when(mgmt == "oa" ~  biomass/as.numeric(nullOA[1,"biomass"]),
                          TRUE ~ biomass/as.numeric(nullCE[1,"biomass"])),
         diffCtch=case_when(mgmt=="oa" ~  catch/as.numeric(nullOA[1,"catch"]),
                          TRUE ~ catch/as.numeric(nullCE[1,"catch"])))

szMgmtBen203<-szMgmtBen202%>%
  bind_rows(.,zeros)

### open access

szMgmtBenCtchOA20<-ggplot(szMgmtBen203[szMgmtBen203$mgmt=="oa",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  # geom_smooth(size=0.8,se=FALSE)+#
  geom_line(size=0.8)+
  scale_color_manual(values = rev(szCols),name="Adult\nmovement",labels=c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(70,160))+
  labs(x="",y="\n\n",title = "")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

### constant effort at MSY

szMgmtBenCtchCE20<-ggplot(szMgmtBen203[szMgmtBen203$mgmt=="ce",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  # geom_smooth(size=0.8,se=FALSE)+
  geom_line(size=0.8)+
  scale_color_manual(values = rev(szCols),name="Adult\nmovement",labels=c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(70,160))+
  labs(x="",y="\n\n",title = "Positive impacts\n")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

goodPlt20<-szMgmtBenCtchOA20 + szMgmtBenCtchCE20
  # plot_annotation(title = "Adult movement by number of farms - benefits", theme = theme(plot.title = element_text(size = 18)))

########################################################
### Stress/damage to wild population

szMgmtNeg20<-read_csv("runs/movement/farmEq_mpaMgmtAMNeg_20.csv")

szMgmtNeg202<-szMgmtNeg20%>%
  mutate(diffBm=case_when(mgmt == "oa" ~  biomass/as.numeric(nullOA[1,"biomass"]),
                          TRUE ~ biomass/as.numeric(nullCE[1,"biomass"])),
         diffCtch=case_when(mgmt=="oa" ~  catch/as.numeric(nullOA[1,"catch"]),
                          TRUE ~ catch/as.numeric(nullCE[1,"catch"])))

szMgmtNeg203<-szMgmtNeg202%>%
  bind_rows(.,zeros)

### Open access

szMgmtNegCtchOA20<-ggplot(szMgmtNeg203[szMgmtNeg203$mgmt=="oa",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  # geom_smooth(size=0.8,se=FALSE)+
  geom_line(size=0.8)+
  scale_color_manual(values = rev(szCols),name="Adult\nmovement",labels=c("None","Low","Moderate","High"))+
scale_y_continuous(limits = c(70,160))+
  labs(x="",y="\n\n",title = "")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))


#constant effort at MSY

szMgmtNegCtchCE20<-ggplot(szMgmtNeg203[szMgmtNeg203$mgmt=="ce",],aes(x=mpaSz*100,y=diffCtch*100,group=aMove,color=as.factor(aMove)))+
  geom_hline(yintercept = 100,color="gray66")+
  # geom_smooth(size=0.8,se=FALSE)+
  geom_line(size=0.8)+
  scale_color_manual(values = rev(szCols),name="Adult\nmovement",c("None","Low","Moderate","High"))+
  scale_y_continuous(limits = c(70,160))+
  labs(x="",y="\n\n",title = "Negative impacts\n")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.text=element_text(size=12),
        axis.title = element_text(size=16),
        legend.text = element_text(size=12),
        legend.title = element_text(size=16))

fig3Plts20<-((szMgmtBenCtchCE20 + szMgmtNegCtchCE20)/(szMgmtBenCtchOA20 + szMgmtNegCtchOA20)) +
  plot_annotation(tag_levels = 'A') + 
  plot_layout(guides="collect")


fig3Plts20
# (fig2Plts/x_lab2) + plot_layout(heights = c(1,0.05))

```

